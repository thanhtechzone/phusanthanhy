<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ph√≤ng Kh√°m S·∫£n Ph·ª• Khoa Th√†nh √ù - L·ªãch Kh√°m</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .glass{background:rgba(255,255,255,0.6);backdrop-filter:blur(12px);-webkit-backdrop-filter:blur(12px);}
    .badge{padding:2px 10px;border-radius:999px;font-size:12px;border:1px solid transparent}
  </style>
  <script>
    const weekdayLabels = ['Ch·ªß nh·∫≠t','Th·ª© 2','Th·ª© 3','Th·ª© 4','Th·ª© 5','Th·ª© 6','Th·ª© 7'];
    function getWeekDatesMondayFirst(){
      const today = new Date();
      const jsDay = today.getDay();
      const indexFromMonday = (jsDay + 6) % 7;
      const monday = new Date(today);
      monday.setDate(today.getDate() - indexFromMonday);
      const arr = [];
      for(let i=0;i<7;i++){ const d = new Date(monday); d.setDate(monday.getDate()+i); arr.push(d); }
      return arr;
    }
    function fmtDate(d){
      const dd = String(d.getDate()).padStart(2,'0');
      const mm = String(d.getMonth()+1).padStart(2,'0');
      return `${dd}/${mm}`;
    }
    async function loadSchedule(){
      const res = await fetch('/api/schedule');
      const data = await res.json();
      const byDay = Array.from({length:7},()=>[]);
      data.forEach(s=>{byDay[s.weekday].push(s)});
      const grid = document.getElementById('grid'); grid.innerHTML = '';
      const weekOrder = [1,2,3,4,5,6,0];
      const weekDates = getWeekDatesMondayFirst();
      for(const d of weekOrder){
        const dayEl = document.createElement('div');
        dayEl.className='glass rounded-xl shadow border border-white/40 overflow-hidden backdrop-saturate-150 animate-[fadeIn_0.4s_ease]';
        const offset = d===0 ? 6 : d-1;
        const dateStr = fmtDate(weekDates[offset]);
        const slots = byDay[d];
        const isOpen = slots.some(s=>s.status!=='CLOSED');
        const dayBadge = isOpen ? '<span class=\'badge bg-cyan-50/80 text-cyan-700 border-cyan-200\'>M·ªü</span>' : '<span class=\'badge bg-rose-50/80 text-rose-700 border-rose-200\'>ƒê√≥ng</span>';
        dayEl.innerHTML = `<div class=\"px-4 py-3 bg-white/60 border-b border-white/50 font-semibold flex items-center justify-between\"><span>${weekdayLabels[d]} <span class=\"text-sm text-slate-600\">${dateStr}</span></span><span>${dayBadge}</span></div>`;
        if(slots.length===0){
          const empty = document.createElement('div'); empty.className='px-4 py-6 text-sm text-slate-600';
          empty.innerHTML = `Kh√¥ng c√≥ l·ªãch`;
          dayEl.appendChild(empty);
        } else {
          slots.forEach(s=>{
            const slot = document.createElement('div');
            slot.className='px-4 py-3 border-b border-white/40 hover:bg-white/50 transition';
            slot.innerHTML = `
              <div class=\"min-w-0\">
                <div class=\"font-semibold\">${s.start} - ${s.end}</div>
                ${s.note ? `<div class=\"text-xs text-slate-500 mt-1\">Ghi ch√∫: ${s.note}</div>` : ''}
              </div>
              `;
            dayEl.appendChild(slot);
          })
        }
        grid.appendChild(dayEl);
      }
    }
    window.addEventListener('DOMContentLoaded', loadSchedule);
  </script>
  <meta name="description" content="Ph√≤ng Kh√°m S·∫£n Ph·ª• Khoa Th√†nh √ù - L·ªãch kh√°m trong tu·∫ßn" />
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='0.9em' font-size='90'>ü©∫</text></svg>">
 </head>
<body>
  <header class="sticky top-0 z-10 bg-gradient-to-r from-cyan-500 to-blue-600 text-white shadow">
    <div class="max-w-6xl mx-auto px-4 py-4">
      <div class="flex items-center justify-between">
        <h1 class="text-lg font-semibold tracking-wide">PH√íNG KH√ÅM S·∫¢N PH·ª§ KHOA TH√ÄNH √ù ‚Äî L·ªãch Kh√°m</h1>
        <a class="text-white/80 hover:text-white text-sm" href="/admin.html">Qu·∫£n tr·ªã</a>
      </div>
      <div class="text-white/90 text-sm mt-1">Th·∫°c sƒ© B√°c sƒ© n·ªôi tr√∫ Phan Th·ªã Minh √ù</div>
    </div>
  </header>
  <div class="relative min-h-screen bg-gradient-to-br from-slate-100 to-sky-100">
    <div class="absolute inset-0 bg-[radial-gradient(circle_at_20%_20%,rgba(56,189,248,0.25),transparent_40%),radial-gradient(circle_at_80%_0%,rgba(14,165,233,0.25),transparent_35%)]"></div>
    <div class="relative max-w-6xl mx-auto px-4 py-6">
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-6 gap-6" id="grid"></div>
    </div>
  </div>
  <footer class="text-slate-500 text-center py-6 text-sm">¬© <span id="year"></span> Ph√≤ng Kh√°m S·∫£n Ph·ª• Khoa Th√†nh √ù</footer>
  <script>document.getElementById('year').textContent=new Date().getFullYear()</script>
</body>
</html>


